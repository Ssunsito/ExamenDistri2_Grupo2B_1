@model ProyectoDistri2.Models.Reserva

@{
    ViewBag.Title = "Crear Reserva";
}

<h2>Crear Reserva</h2>

<div id="alerta" class="alert" style="display:none;"></div>

@using (Html.BeginForm("Crear", "Reservas", FormMethod.Post, new { id = "formReserva" }))
{
    @Html.HiddenFor(m => m.EspacioId)

    <div class="form-group">
        <label>Fecha Inicio</label>
        @Html.TextBoxFor(m => m.FechaInicio, "{0:yyyy-MM-ddTHH:mm}", new { @class = "form-control", type = "datetime-local" })
    </div>

    <div class="form-group">
        <label>Fecha Fin</label>
        @Html.TextBoxFor(m => m.FechaFin, "{0:yyyy-MM-ddTHH:mm}", new { @class = "form-control", type = "datetime-local" })
    </div>

    <button type="submit" class="btn btn-success">Guardar Reserva</button>
    @Html.ActionLink("Volver a Espacios", "Index", null, new { @class = "btn btn-secondary" })
}

@section scripts {
    <script>
    $("#formReserva").submit(function (e) {
        e.preventDefault();
        $.ajax({
            url: this.action,
            type: "POST",
            data: $(this).serialize(),
            success: function (resp) {
                var alerta = $("#alerta");
                alerta.removeClass("alert-success alert-danger");

                if (resp.success) {
                    alerta.addClass("alert-success");
                } else {
                    alerta.addClass("alert-danger");
                }

                alerta.text(resp.message).fadeIn();

                // Ocultar después de 5 segundos
                setTimeout(() => alerta.fadeOut(), 5000);
            },
            error: function () {
                alert("Error inesperado al intentar guardar la reserva.");
            }
        });
    });
    </script>
}
